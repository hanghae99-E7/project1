<!doctype html>
<html lang="en">
<head>

    <!-- Webpage Title -->
    <title>Home | SWEETER</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <meta property="og:title" content="스위터 - 세상을 달달하게"/>
    <meta property="og:description" content="mini project for Web Plus"/>
    <meta property="og:image" content="{{ url_for('static', filename='ogimg.png') }}"/>

    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <!-- Font Awesome CSS -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='mystyle.css') }}" rel="stylesheet">

    <style>
        body {
            padding-top: 3.25rem;
        }

        .card {
            margin-bottom: 1.5rem
        }

    </style>

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="{{ url_for('static', filename='myjs.js') }}"></script>
    <script>
        $(document).ready(function () {
            get_posts()
        })

        function get_posts(username) {
            if (username == undefined) {
                username = ""
            }
            $("#post-box").empty()
            $.ajax({
                type: "GET",
                url: `/get_posts?username_give=${username}`,
                data: {},
                success: function (response) {
                    if (response["result"] == "success") {
                        let posts = response["posts"]
                        for (let i = 0; i < posts.length; i++) {
                            let post = posts[i]
                            let time_post = new Date(post["date"])
                            let time_before = time2str(time_post)
                            let class_heart = post['heart_by_me'] ? "fa-heart" : "fa-heart-o"
                            let count_heart = post['count_heart']
                            let html_temp = `<div class="card" id="${post["_id"]}">
                                                <div class="card-image">
                                                    <figure class="image is-4by3">
                                                        <img src="/static/${post['posts_pic_real']}" alt="Placeholder image">
                                                    </figure>
                                                </div>
                                                <div class="card-content">
                                                    <div class="media">
                                                        <div class="media-left">
                                                            <a class="image is-48x48" href="/user/${post['username']}">
                                                                <img class="is-rounded" src="/static/${post['profile_pic_real']}" alt="Placeholder image">
                                                            </a>
                                                        </div>
                                                        <div class="media-content">
                                                            <p class="title is-4">${post['profile_name']}</p>
                                                            <p class="subtitle is-6">
                                                                <span>@${post['username']}</span>&nbsp;&nbsp;&nbsp;
                                                                <span style="color: gray">${time_before}</span>
                                                            </p>
                                                        </div>
                                                        <div class="media-right" style="padding-top: 30px">
                                                            <a class="level-item is-sparta" aria-label="heart" onclick="toggle_like('${post['_id']}', 'heart')">
                                                                    <span class="icon is-small">
                                                                        <i class="fa ${class_heart}" aria-hidden="true"></i>
                                                                    </span>&nbsp;
                                                                <span class="like-num">${num2str(count_heart)}</span>
                                                            </a>
                                                        </div>
                                                    </div>

                                                    <div class="content">
                                                        ${post['comment']}
                                                    </div>

                                                    <div class="media">
                                                        <div class="media-left">
                                                            <figure class="image is-48x48">
                                                                <img src="${post['album_img']}"
                                                                     alt="Placeholder image">
                                                            </figure>
                                                        </div>
                                                        <div class="media-content">
                                                            <p>
                                                                <span class="title is-5">${post['song_title']}</span>&nbsp;
                                                                <span class="subtitle is-6">- ${post['song_artist']}</span>
                                                            </p>
                                                            <p class="song-img" style="color: gray">${post['album_title']}</p>
                                                        </div>
                                                        <div class="media-right">
                                                            <figure class="image is-48x48">
                                                                <img src="/static/mood_pics/${post['mood']}.png" alt="Placeholder image">
                                                            </figure>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`
                            $("#post-box").append(html_temp)
                        }
                    }
                }
            })
        }
    </script>
</head>
<body>
<!--상단 헤더 시작-->
<nav class="navbar is-fixed-top is-white" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            <img src="{{ url_for('static', filename='logo.png') }}">
            <strong class="is-sparta"
                    style="font-family: 'Stylish', sans-serif;font-size: larger;">SWEETER</strong>
        </a>
    </div>
</nav>
<!--상단 헤더 끝-->
<!--글쓰기 section 시작-->
<section class="section">
    <article class="media">
        <figure class="media-left" style="align-self: center">
            <a class="image is-32x32" href="/user/{{ user_info.username }}">
                <img class="is-rounded" src="{{ url_for('static', filename=user_info.profile_pic_real) }}">
            </a>
        </figure>
        <div class="media-content">
            <div class="field">
                <p class="control">
                    <input id="input-post" class="input is-rounded" placeholder="무슨 생각을 하고 계신가요?"
                           onclick='$("#modal-post").addClass("is-active")'></p>
            </div>
        </div>
    </article>
    <div class="modal" id="modal-post">
        <div class="modal-background" onclick='$("#modal-post").removeClass("is-active")'></div>
        <div class="modal-content">
            <div class="box">
                <article class="media">
                    <div class="media-content">
                        <div class="field">
                            <p class="control">
                                        <textarea id="textarea-post" class="textarea"
                                                  placeholder="무슨 생각을 하고 계신가요?"></textarea>
                            </p>
                        </div>
                        <nav class="level is-mobile">
                            <div class="level-left">

                            </div>
                            <div class="level-right">
                                <div class="level-item">
                                    <a class="button is-sparta" onclick="post()">포스팅하기</a>
                                </div>
                                <div class="level-item">
                                    <a class="button is-sparta is-outlined"
                                       onclick='$("#modal-post").removeClass("is-active")'>취소</a>
                                </div>
                            </div>
                        </nav>
                    </div>
                </article>
            </div>
        </div>
        <button class="modal-close is-large" aria-label="close"
                onclick='$("#modal-post").removeClass("is-active")'></button>
    </div>
</section>
<!--글쓰기 section 끝-->
<!--글목록(user 전체) section 시작-->
<section class="section">
    <div id="post-box" class="container">
        <!--테스트 포스트 시작-->
        <div class="card">
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src={{ url_for("static", filename="posts_pics/username-post-2022-01-01.jpg") }}
                    alt="Placeholder image">
                </figure>
            </div>
            <div class="card-content">
                <div class="media">
                    <div class="media-left">
                        <figure class="image is-48x48">
                            <img class="is-rounded" src={{ url_for("static",
                            filename="profile_pics/profile_placeholder.png") }} alt="Placeholder image">
                        </figure>
                    </div>
                    <div class="media-content">
                        <p class="title is-4">nickName</p>
                        <p class="subtitle is-6">
                            <span>@username</span>&nbsp;&nbsp;&nbsp;
                            <span style="color: gray">10분 전</span>
                        </p>
                    </div>
                    <div class="media-right" style="padding-top: 30px">
                        <a class="level-item is-sparta" aria-label="heart" onclick="toggle_like('', 'heart')">
                                <span class="icon is-small">
                                    <i class="fa fa-heart" aria-hidden="true"></i>
                                </span>&nbsp;
                            <span class="like-num">2.7k</span>
                        </a>
                    </div>
                </div>

                <div class="content">
                    테스트 코멘트입니다. 여러분의 의견을 적어주세요.
                </div>

                <div class="media">
                    <div class="media-left">
                        <figure class="image is-48x48">
                            <img src="https://image.genie.co.kr/Y/IMAGE/IMG_ALBUM/080/274/035/80274035_1321251409269_1_140x140.JPG/dims/resize/Q_80,0"
                                 alt="Placeholder image">
                        </figure>
                    </div>
                    <div class="media-content">
                        <p>
                            <span class="title is-5">Replay</span>&nbsp;
                            <span class="subtitle is-6">- 김동률</span>
                        </p>
                        <p class="song-img" style="color: gray">kimdongrYULE</p>
                    </div>
                    <div class="media-left">
                        <p>이 노래를 함께 듣는다면,</p>
                        <p>당신의 기분도</p>
                    </div>
                    <div class="media-right">
                        <figure class="image is-48x48">
                            <img src={{ url_for("static",
                            filename="mood_pics/rainy.png") }} alt="Placeholder image">
                        </figure>
                    </div>
                </div>
            </div>
        </div>
        <!--테스트 포스트 끝-->
        <!--개별 포스트 시작-->
        <div class="box">
            <article class="media">
                <div class="media-left">
                    <a class="image is-64x64" href="#">
                        <img class="is-rounded"
                             src={{ url_for("static",
                        filename="profile_pics/profile_placeholder.png") }} alt="Image">
                    </a>
                </div>
                <div class="media-content">
                    <div class="content">
                        <p>
                            <strong>홍길동</strong> <small>@username</small> <small>10분 전</small>
                            <br>
                            글을 적는 칸
                        </p>
                    </div>
                    <nav class="level is-mobile">
                        <div class="level-left">
                            <a class="level-item is-sparta" aria-label="heart" onclick="toggle_like('', 'heart')">
                                <span class="icon is-small"><i class="fa fa-heart"
                                                               aria-hidden="true"></i></span>&nbsp;<span
                                    class="like-num">2.7k</span>
                            </a>
                        </div>

                    </nav>
                </div>
            </article>
        </div>
        <!--개별 포스트 끝-->
    </div>
</section>
<!--글목록(user 전체) section 끝-->
</body>
</html>